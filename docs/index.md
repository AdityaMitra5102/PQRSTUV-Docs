# PQRSTUV - Post Quantum Resource Station Tucked Under Vault

## Abstract

PQRSTUV is a cryptographic device used for secure management of cryptographic secrets and with support for Post Quantum Cryptographic algorithms. It does not support symmetric cryptography and is focused on asymmetric cryptography only.

BCP Boilerplate 14:

The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in BCP 14 [RFC2119](https://www.rfc-editor.org/rfc/rfc2119.txt) [RFC8174](https://www.rfc-editor.org/rfc/rfc8174.txt) when, and only when, they appear in all capitals, as shown here.

## Technical details

![Schematic](data:image/png;base64,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AKBUBFoAAAAAlIpACwAAAIBSEWgBAAAAUCoCLQAAAABKRaAFAAAAQKkItAAAAAAoFYEWAAAAAKUi0AIAAACgVARaAAAAAJSKQAsAAACAUhFoAQAAAFAqAi0AAAAASkWgBQAAAECpCLQAAADYZ7Zv356urq7i8KOqq6sr27dvLw4DJSbQAgAAGAJ6e3szZ86cjB07NiNGjKgc9fX1WblyZXp7e4un7Be1tbUZP358Vq5cWSw9ZAOf4cGor6/PiBEjdgvTVq5cmfHjx6e2tnbQ+MP1UK4J2H8EWgAAACW3devWHH744Vm8eHG6u7tTW1uburq61NTUpLOzM+ecc07q6+sfkVCrpqYmVVVVefazn10sPSoGruPYY48tloASE2gBAACUXHNzc/r6+lJXV5eenp5s3rw5HR0d2bZtWzZu3Jja2tp0d3fntNNOK566z23evDl33313TjzxxGLpUXHiiSemv78/HR0dxRJQYgItAACAkuvs7EySrFixIqNGjRpUGzduXNauXVvps5YUMBQItADgUbBjx45cd911xWEA2C9GjRqVjRs3ZuPGjTnooIMG1QbW3ho9enRlfaixY8emtbV1j48o7rpW1fr16ytrdg2sXbW3tayyc3H2hoaGjBw5crf32l+6uroqa4ntqrW1NSNGjKh8zqampso9GDlyZJqamvb4+fdm69atlc/V3t5eLAP7mEALAB5BO3bsyAc+8IG85CUvyerVq4tlAHhYampqkiSTJk3a6wyscePGZdy4camurq6M9fb25rjjjsvixYtTVVWVlpaWzJ49O319fWlubr7fdbe+8pWv5KSTTkp3d3dqamry5Cc/udgySHt7e8aPH5+1a9dm4sSJlffq6empvNej4aabbspxxx2Xtra2jB49OnV1dUmStra2B/2I5tatWzNhwoT09fVlzZo1aWhoKLYA+5hACwAeAbsGWQsWLMgdd9xRbAGAh23VqlWpqqqqhEsDOxtu3bq12DrIaaedlp6enqxZsyabN2/OzJkzc/HFF2fbtm1pbGxMd3d3rrjiiuJpSZLFixenpaUld911V7Zt25YxY8YUWwZpampKkqxbty7t7e2V97rtttsqi9c/0PXuDwMB21133ZWOjo50dHRkw4YNyc5HNB/omnp7e4VZ8CgQaAHAftT/x98LsgDY78aNG5fu7u40NjYmO4OYc845J0cddVRGjx6dOXPm7DZza/v27ens7Extbe0eQ5hFixYlSZYuXVosJUkuv/zyzJw5c9CMr73Zvn17+vr6UlNTs9ti8dXV1Zk4cWKS5IYbbhhUeyRMmjQpK1asGPQ5xowZU5mp9cMf/nCX7sF6e3tTX18vzIJHgUALAPaT/j/+Pn1fXLHXIOu6666rrB/icDgcDseux7Rp04p/bDygUaNGZcWKFbnrrruyZs2aNDY2pqamJj09PVm8eHFqamoGrVV16623Vv65tbV1t2NgZlZfX1+lb1cvfvGLi0N7NWrUqPT392fbtm3F0qAZUL/5zW8G1R4JRx99dHEoSXLMMcckSe68885iKdklzOru7hZmwaNAoAUA+8mIxz0hI9/8/nzoQx8qlpIkJ598cvr7+x0Oh8Ph2O248sori39sPGjV1dVpaGjIihUrsm3btmzZsiWTJk1KkjQ3N2f9+vVJku9///tJku7u7jQ3N+/x2Nfa29vT0NAwaAH6o446Km1tbcXWR11x8fyigTCrrq5OmAWPAoEWAOxn733ve9Pf37/XYAsA9qcxY8akvb29Emp9+ctfHlSfPXv2boFa8fhb9fb2ZuzYsZk8eXK6u7vzzne+M+vWravsvDjwqGSZnH/++UmSTZs2PeA6W8C+J9ACgEeIYAuA/aG1tTUjRox4wF0CBx6tG1hL64gjjkiS3HjjjYP6dtXV1ZWurq7i8EN2ySWXpLu7O5MmTcq2bdsyc+bMnHjiiZWdFw877LDiKQe8hoaGrFmzJn19fZkwYYJQCx5hAi0AeIQNBFvnnXdesQQAD9mhhx6aJNm2bVt6e3uL5YqB9RxHjRqVJDnuuOOSnQvIFxeMHzB+/PiMHz++OPyQDYRmZ555ZrGUJLnpppuKQ4Ps7fr25Kc//WlxaL9paGjI5ZdfLtSCR4FACwAeJa985SuLQwDwkL361a9OVVVVenp6ctppp+0W/vT29qa1tbWyTtWpp56a7Fxra+BRv6ampt3CsJUrVyZJZbe/v8VAiFZ83LG3tzdNTU1Zu3btoPEBtbW1SWEB+70ZWMT95ptvLpb2q7PPPjuNjY3p6+vL29/+9t3uI7B/CLQAAABKrLq6Ohs2bEhVVVU6OztTU1OTkSNHpr6+PmPHjs0hhxxSWeB9zZo1GTduXOXcRYsWpba2Np2dnTnuuOPS1NSUOXPmZOzYsTnnnHNSVVWVlpaWXd7t4Tn77LOTJG1tbamvr09ra2saGhpy+OGHZ/PmzZk9e3bxlCTJW97yliTJ6aefnvr6+vudAfWa17wmSbJ48eLU19envb292LLfrFixIo2Njenu7k59fb1QCx4BAi0AAICSGzNmTG677bZcfvnlqaurS19fXzo7O9Pd3Z3a2to0Njamp6dnt934qqur09HRkZaWllRVVaWtrS2LFy9OX19fJaAZM2bMoHMejjFjxlR2W+zs7Exzc3N6enoya9asbN68ea87Cp511lmVsKuzszP33HNPsaVi3Lhxufzyy1NTU5POzs7ceeedxZb9asWKFZk0aZJQCx4hI/r3xZYVAPAIeuq0RUmSX105t1g6oJTlOgEAoGzM0AIAAACgVARaAAAAAJSKQAsAAACAUhFoAQAAAFAqAi0AAAAASkWgBQAAAECpCLQAAAAAKBWBFgAAAAClItACAAAAoFQEWgAAAACUikALAAAAgFIRaAEAAABQKgItAAAAAEpFoAUAAABAqQi0AAAAACgVgRYAAAAApSLQAgAAAKBUBFoAAAAAlIpACwAAAIBSEWgBAAAAUCoCLQAAAABKRaAFAAAAQKkItAAAAAAoFYEWAAAAAKUi0AIAAACgVARaAAAAAJSKQAsAAACAUhFoAQAAAFAqAi0AAAAASkWgBQAAAECpCLQAAAAAKBWBFgAAAAClItACAAAAoFQEWgAAAACUikALAAAAgFIRaAEAAABQKgItAAAAAEpFoAUAAABAqQi0AAAAACgVgRYAAAAApSLQAgAAAKBUBFoAAAAAlIpACwAAAIBSEWgBAAAAUCoCLQAAAABKRaAFAAAAQKkItAAAAAAoFYEWAAAAAKUi0AIAAACgVARaAAAAAJSKQAsAAACAUhFoAQAAAFAqAi0AAAAASkWgBQAAAECpCLQAAAAAKBWBFgAAAAClItACAAAAoFQEWgAAAACUikALAAAAgFIRaAEAAABQKgItAAAAAEpFoAUAAABAqQi0AAAAACgVgRYAAAAApSLQAgAAAKBUBFoAAAAAlIpACwAAAIBSGdHf399fHITh6pwLL84Va68tDgMHmKpxb0iS9HV9oVg6oJTlOgGGo7eeNDGf/rfFxWEASsIMLdhp2UdXC7MAAIaBo498Ua5ctqA4DECJmKEFSa7p+Foa3tOcJJlz8dS8qn5ssQU4gJxy3vVJkms+PLFYOqCU5ToBhoOPX/bFXH1lZ6oOfnI2rr0yzx91WLEFgBIxQ4th73u33Jop51+YJHlb0+uEWQAAQ8xXrvtOrr6yM0myatkiYRbAECDQYlj7zT2/y9QZ8/KHP/4pda97aU4/q77YAgBAiW258bYsW/TpJMmHLpyeE185rtgCQAkJtBjWpk6flx/ctj3/fNToNH/gjGIZAIAS++X/3J0lF65KkrxnyuS8e0pDsQWAkhJoMWydf/El+fLXv5WnPrUqsy6aUiwDAFByS+etzq9/tSMnTRifSy48v1gGoMQEWgxLKz75mVy66uokSfPCM/L0Z4wstgAAUGKtCz6VrTduy/NrDrOjIcAQJNBi2PnKN76d8xa2JkmmX3haXjL2+cUWAABK7FNXdKbji/+Zxz/ucblq+aJUHfSUYgsAJSfQYlj579t/nKkz5iVJJk+dmBPfeHyxBQCAEvt65435xIovJkmuXLYgRx/xwmILAEOAQIth489/+UumTp+Xu3f8Jq/816Pzjve8odgCAECJ3XrLjyuLwF88/d15y4mvLrYAMEQItBg2pk6fm83/dUue98JDc8Eii8ADAAwlv/3N/2bJ3NX5y1//mre99eTMPHtqsQWAIUSgxbAw70MrsvbL1+fJT/mHXLDwzPy/xz222AIAQIktmbc6P/nxL/PKl9Zm5cUXFssADDECLYa8VZ/7Ypas+ESSpHnBGXnOqGcUWwAAKLFLWz+T73bdkkOf+fSsWr6wWAZgCBJoMaR9a9NNeccF9/1PzbunvznHv/zIYgsAACV2zdVfz3Vrv5kkWbV8Yf7paU8ttgAwBAm0GLJ++j+/yrSdOxq+seEVedPkCcUWAABK7DvfvDkf+eA1SZKPL52X8WOPLrYAMEQJtBiypk6fmzt//j956bgj8p4Zby2WAQAosTt6fpGl81YnSWa/66xMOeX1xRYAhjCBFkPSO2cvyje/e2Oec9jTM8uOhgAAQ8of//DnLJm3Or/73f+l4bV1WfDexmILAEOcQIshp+XyK3PlZ7+Qxz72MZm18Mw85SlPLLYAAFBiS+auym23/iRj//nFWbV8UbEMwDAg0GJI+cy663PhBz+SJLlg0ZQ8/8XPKbYAAFBiH7v0unzza99LddVBWb18UR7zGH+lARiO/NefIePGm3+QaTPmJ0nOetfrMmHiMcUWAABKbN21386a1V9NkqxatiiHP/fQYgsAw4RAiyHh7h2/zZTp8/LHP/0pr3nDv+S0t9UXWwAAKLGbNt2aD150dZLk0vkzU/+K44stAAwjAi2GhGkz5uVH2+/IUbXPy4x5pxfLAACU2C9/0Zul8z6ZJDlv2qlpPN0O1gDDnUCL0nvfRcuz/htdedrTR2bWwjOLZQAASm7xhatz16935HWvenmWz35/sQzAMCTQotT+ffWaXLa6PUkya+GUPPVpVcUWAABKrOUDn8zNW3ryoueNsqMhABUCLUpr3YaNef9FH0ySzJh3esYcM7rYAgBAiX3y419J55duyBMe/7isXrYoT3nSPxRbABimBFqU0q09t1d2NDztbfV5zRv+pdgCAECJ/cdXNufKti8nSVZ/8KIc9aLnF1sAGMYEWpTOH/74x0yZPi99v/ltTqg7Jme963XFFgAASuwHN9+eJfNWJ0mWzDw3b6o7odgCwDAn0KJ0ps2Yn5u+/8O84MXPyayFU4plAABKbEff77Jk3lXp/2t/3t7wpkx/h01/ANidQItSmbP8snx2/Vdz0FP+IRcsnJLHPvYxxRYAAEpsydzV+dmdv8qrjj82bYtmF8sAkAi0KJNPfOa6tK5clSSZtWhKnn3Y04otAACU2IeXrs3m//xBnvOsZ+bK5QuLZQCoEGhRCt+4oTtnz7koSfKeGW/NceNeXGwBAKDEPvvJr+ULn/1WkuSq5YvyjH88pNgCABUCLQ54P/7ZLzJ1+rwkySmnnpA3Nryi2AIAQIl1bdiatn/7fJLkE60LcvwxY4otADCIQIsD3rQZ8/OzX/4qx7/8yLzr/FOKZQAASuz2236epTt3NLzw3e/IGW88qdgCALsRaHFAe/ushdm4+aY8Z9QzMmuhHW4AAIaS3//+D1k8d3XuvfcPOe0NJ2b+eWcXWwBgjwRaHLAWf+SKrL7mi3nc4x6b2Yum5ElPfmKxBQCAElty4VXpue2nOe4lR+bKZQuKZQDYK4EWB6T2L3dm/r+1JTt3NDz8Bc8utgAAUGIrL70uGzdsyT9WV2X1soUZMWJEsQUA9kqgxQFn09bvZ+r0uUmSd5x7cl75r0cXWwAAKLEvXbMxa1d/NUmyevmi1DzHLy8BeGgEWhxQ7urbkakz5uUvf/lrTnrjyzJ5yquLLQAAlNiN3701H1rcniS5bMGsvHrcS4stAPCABFocUKbNmJfbbr8zRx/7/Jx/4anFMgAAJfbzn96VJXNXJUne//Yzcvapby62AMCDItDigHHugtZ0fPM7eeY/HZJZC6cUywAAlNySeatyd+89OXnihLQ0n1csA8CDJtDigPDhK69O26c+kyRpXnBGDvnHg4otAACU2NJ5q3PL1ttzxPNG29EQgL+ZQItH3Rf/45uZvviSJMnM+WfkyJeMLrYAAFBiq1euz/XrNuUfnvj3ueqSRXnSE59YbAGAh0SgxaPqlv/uybQZ85IkZ7z9Nal/vUVBAQCGkuvXbcrqj65LkqxatjBHPv/wYgs8IrZv356urq7iMFBSAi0eNf/3+z9k6ox5+e3v/jevqh+baY2vLbYAAFBi39+yPUvnrU6StDSfl5MnTii2sB9s3749ra2tqa+vz4gRIyrH2LFj09TUNGxDndra2owfPz4rV64slh5VA9/T2LFji6U92r59e0aOHJkRI0aktbW1WN7nurq6MmLEiNTX1xdLD8vAzyP8rQRaPGqmTp+bLT/4UV505HNzwaIzi2UAAErs7rt+myXz7wuzzj71zXn/288otrAftLe3p7a2Ns3Nzens7ExNTU3q6upSW1ub7u7utLW1Zfz48Wlqakpvb2/x9FJrb29PfX195syZUywlSWpqalJVVZVnP/vZxdIBobu7+0EFVLNnz05fX19xGIYdgRaPigtaL83nO7+eqqon54KFZ+bv/s6PIgDAULJk3ur84qd35dXjXprLFswqltkP2tvbM3ny5PT19aWxsTE9PT3Ztm1bOjo6snnz5tx11125/PLLU1VVlba2trzrXe8qvkSp3Xnnnens7MyNN95YLCVJNm/enLvvvjsnnnhisXTAWLp0abZv314crujq6sratWuLwzAsSRF4xH28/fNZ/rGrkiTNC8/MPx361GILAAAldsnFa3Ljd2/NqOc8K6uWLyyW2Q+2b9+eyZMnJ0laWlqyYsWKjBo1alBPdXV1zj777GzYsCFJsnbt2rS3tw/q4dEzadKk9PX1pampqViqmDp1apKksbGxWIJhR6DFI+pr39mUxrmLkyTnzZqUY49/UbEFAIASW3vVV/Plz9+35s7qZQvz1OqRSZIdO3bkuuuuK7azjyxfvjzZ+VjdzJkzi+VBxowZk5aWliTJhRdeOKg2sJ5TV1dXtm7dmoaGhsqaR6NHj77fR+K2bt2apqamyvpOA+su7S0023UtpdbW1owePXrQ2kq9vb1pbW3N2LFjK70jR45MQ0NDtm7dWukbWOOpubk5SdLZ2Vnp3/V6d/1sRdu3b09TU1PlGkbsXNNqb5+3tbW18vq9vb2Dzh05cuTDeqTz3e9+d2pra9PZ2Zn169cXy2ltbU1PT09aWlpy2GGHFcsVe7pvo0ePfsBram9vH3TO2LFj93ivBgzczwdzjx6KlStX7vHa72/mGsOTQItHzB0//XmmTr9vR8O3nH5C3vCWlxdbAAAosY0btmTlh+8Lra5ctiAvfck/Z8eOHfnABz6Ql7zkJVm9+r41tdj3rr/++iTJjBkziqU9evOb35wk6enpGRQODbjlllsyYcKEdHd3p66uLnV1denp6Ulzc/MeZxB1dXVlwoQJaWtry8SJE9PS0pLGxsZs2rQpkydP3uM5A+bMmZPm5ub09PSktrY22RnK1NfXp7m5OX19fZk9e3ZaWlpy7LHHZu3atTnqqKMqYcuTn/zk1NXVpaamJklSVVVVueZDDz100HvtydatW1NbW5u2trZB5w583rFjx+41CLrpppty3HHHpa2tLaNHj05dXV2SpK2tLaeddlqx/QF96EMfSpKcfvrpg95z+/btWbp0aWpqanLWWWftcsZgxfs28Fmy85oOP/zwPX7fTU1NmTx5crq7u1NbW1s5Z/z48bn66quL7ftNQ0NDzjnnnEHf+cAjsrW1tXu8doYvgRaPmCnT5+Z/fn1XXvbKf07j+04plgEAKLFt//3TLJl7X2A1/7yzc9Irjq8EWQsWLMgdd9xRPIV9pLe3Nz09PUmSF7/4xcXyHo0aNSpVVVVJkh/+8IfFcs4555wsWbKksgZXR0dHtmzZUgkXdp111dvbm9e//vVJki1btqS9vT0zZ87MihUrctttt1XCor3N9mlra8uaNWvS39+fzZs3J0k+97nPVcK07373u7n44oszc+bMdHR05PLLL0+SXHbZZcnOGWcdHR155zvfmSQ59thjK9fc0NCwyzvt2SmnnJK+vr60tLRk8+bNlXNvu+22TJo0Kd3d3Zk7d27xtGTnY5sTJ07MXXfdVTlv4JHOzs7OhxzAjBs3rrLo+yWXXFIZHxi79NJLU11dPeicXc2dOzfd3d2ZNGlSvvvd71auadu2bWlpaUlfX19OOWXw38W6urrS1taWJNm4cWPlHmzevDlr1qyp1Pa31tbWrF27No2Njdm2bVvlOx+4jr6+vsosPEiSEf39/f3FwaHgqdMWFYd4lP3xV3fmaf2/yqWfOD9PfOLji2WAB+2U8+77LfQ1H55YLB1QynKdAH+re+/9Q97ztuW5/bafZ9KJr8roqr/P6tWrdwuxTj755Fx77bWDxvjbdXV1Zfz48UmSu+66634Dj13V19ens7MzLS0tlccU9zS2qzlz5mTx4sWZNGlSJdQaWIx+9uzZufjii4unZP369TnppJMGnZOdjxxmZwg2ZsyYXc64b8bQQNBVDKW2b99e2bHw7rvvroy3tramubk5dXV16ejoGHROdvlsGzduzLhx45Jdrq22trYSpu2qt7c3hxxySLJzNtvAumQD71X8TAMG3mtP119UvK7e3t4cfvjh6evry5YtW/Kzn/0sJ5100qDPNfD+u35Pu17r3n4Oxo4dm+7u7kHXNXCv9/b97e2+PtDPyp6uMbt878UoYvTo0enp6XnAa9/TzwvDkxlaf6O//G5HcYi9eMxjHpNZC88UZgEADDFL5q7K7bf9PGOPfEG+/cXP7HVG1nXXXVdZF8dx/8eECROKt+8RdfzxxxeHkiSvec1rkiTd3d2VsZtvvjnZGfi0trbudnz5y19Odq6jtid7CidWrFiR/v7+3cKg3t7e/PznP0+S9PX1Dao9HN/+9reTJG95y1uKpWTnQvoDj99t2rSpWM7RRx9dHEqSHHPMMcnOnRcfqurq6qxYsSJJ8va3vz3nnntusvOe3J/vfve7SZK6uro9BkLZ5XN+61vfqowNBHkD323R3n4W9qWBWYZVVVW54oordvsZam1trXzf99xzT/F0hqkhO0PrkfLGN74xb3jDGyq7TTDYp7+wvrJu1oLl78j4CUcVWwAesrLMfCrLdQL8Ldo+dE0++6mv5+n/WJ2Nn7kyhz3rmfm3f/u3vO997yu2mqG1n+w6M2fX2UcPZOTIkenr6xs0W6c4W6ho19lgA3+VHDjngRRn+IzYy0ydAdu3b88VV1yRG2+8ca+vv+u5e5tJNGBPn+2BZhlll1lpu/bsbfbRgAeq72pP17XreHbuXLnr6+zp9R/o82eXGWm79gx8D8X3HzDwnRdf94Hu3Z6uMXv53nf9uXoge7tOhh8ztP5GW7ZsybRp07Jq1apiadi74Xv/lWkz5idJzj7vZGEWAMAQ84XPfiuf/dTXkySrli/KYc96ZpLkve99b/r7+ysLXLN/VVdXVxZEv+WWW4rlPdq+fXtlxssLX/jCYvlhWbduXfr7+/d67C1k2ZP29vbU1NRk8eLFGTVqVC6//PJs3LixcgwHAzOyHmgh+KGktrZ2t5+b4iHMYoBA6280MJV62rRp+cY3vlEsD1u/6r07U2fMT39/f177pnGZdOariy0AAJTYpu/8IB9eujZJ0rZodl51/LHFFsHWI2jixPtmAy9btqxY2qPPfe5zyc6wZE+P/D2QgQAtuzxe9/3vf3+Xjv9fb29vurq6HvQC6b29vZk8eXKycwLBihUrcvbZZ2fcuHGVY18ZuPb7c+ONNybJg9oxcV8aNWpU+vv7s23btr0+QrirI444oji0m4HvaGAtsOwMkR5tA6Hqro+yFm3dujVdXV173XGS4Ueg9TfYsmXLoH+fMGGCUGunqdPnpefHP8kxx70g759z3x9GAAAMDT+781dZOu++HQ2nv+PMvL3hTcWWQQaCrfPOO69YYh+ZPn16snMdq5UrVxbLg2zdurWyW9xFF11ULCdJfvrTnxaHkiRf+cpXkl0CtCR52cteliT56Ec/Whnb1Q9/+MOMHz/+Qe9QN7DrYm1t7R7Dtr0FYw9nracjjzwySfLZz362WEp2hmsDj/0de+zuoe2B5AUveEGyc3fFvYU+A5/z5S9/eWVs7NixyS7fbdHeZv3tGortyU033VQcGmT79u2Vf66urq4Ea3taZD9JmpubM378+D3uysnwJND6GxQDrewMtfY0Ppy8e/7SfLXrhjzjnw7JBQunFMsAAJTYX//61yyZd1V29P0ub6o7IUtm3rdg9YPxyle+sjjEPjJq1KisWbMmSXLOOeekqalpUGCQneHMypUrKwvOT5o0abdF1wc0NTVl/fr1g8a6urqyePHiJMmpp55aGT/xxBNTU1OTnp6ezJkzZ5cz7nPZZZclSU444YRiaY+e+cz7Hl3t7u7e7TN0dXU94IL527ZtKw7tVUNDQ2pqatLd3b1bENjb25u5c+cmSRobGx8wwHm0jRo1Ko2NjUmSd73rXcVyVq5cme7u7tTU1Az63ge+y7a2tt3Cwvb29pxzzjmDxgYMhI0f/ehHBwVo27dvT0NDQ9auvW8GZ9FAcHXrrbcOGj///POTnT97xe9969at6ezsTFVV1T57RJbyE2j9Dfa0c0uGeah1ycc/mZVX3zd9+YKFUzLykKcUWwAAKLElc6/KD26+PWNe9LysWr6oWOZR1NDQkDVr1qSqqiptbW2pqanJ6NGjU19fn7Fjx+aQQw7JOeeck76+vjQ2NuYjH/lI8SUqGhoactJJJ2Xs2LGV8wcW7W5sbNztsb9rrrkmVVVVWbx4ccaOHZs5c+akqakpo0ePztq1a1NbW/ug14EaNWpUJk2alOwMP+bMmZM5c+ZUrmFvu/2NGzcuVVVV6enpqVz33mb77Grg2s8555yMHTs2TU1NaWhoyHHHHZe2trbU1tZm0aJy/KwvWrQotbW1Wbt2bUaPHp2GhoY0NTVl7NixOeecc1JVVZVrrrlm0Dnjxo1LY2Nj+vr6ctRRR6W+vj719fUZPXp0Jk+eXAnJit785jdX7vchhxxSOWcg3Jw9e3bxlGSXnRZPP/301NfXV0K0hoaGynXU1tamoaEhra2tqa+vz1FH3bce84oVKx7U45cMDwKtv0ExvU6So446atjueHjd9RvS3PLhJMmshVNyxFEH9m8wAAB4aK5s+3K+1rE5T37SE7N62aL8/RMeX2zhUdbQ0JDu7u60tLSkrq4uPT096ezsTHd3d2pra9PY2JiNGzc+YDBw6qmnZt26dcnOR9gGzl+zZs0eA6UxY8aku7u7EkgsXrw4bW1tqaqqSktLSzo6Ou73/Yra29vT0tKSkSNHVl6rpqYmW7Zs2eussiTZsGFD6urq0t3dnc7Oztx5553Flt0Ur72trS1r16592Nf+aKqurk5HR0daWlpSVVWVtWvXpq2trRJidnd37/ExzhUrVqSlpSU1NTXp7OxMZ2dnamtrs3HjxkGz8XZVXV2dDRs2VMLHXXdk7OjoyEEHHVQ44z5nnXVWJezq7OzMPffcU6mtWLEia9asybHHHpu1a9emubk5mzZtyqRJk7Jx48b7/e4Zfkb09+9lj1Qe0HOf+9zs2LEjRx11VL7xjW/ke9/7XiU5Hm5u/tFteflbz8rv7r03U955UqacfWKxBWCfOeW865Mk13z4/1+/40BUlusEeDA6vnhDWhd8MklyTdsH8/p/fUWxhSGgvr4+nZ2d2bhx426zsAAOJGZoPUw7duzI/Pnzc/vtt+faa6/NwQcfPGzDrN/de2+mnD8vv7v33kw86VhhFgDAEHPz97ZVwqzls98vzALgUSfQepgOPvjgTJ06NQcffHCxNOxMmzE/N//othwxZlRmWQQeAGBIuevXv8nSeVclSRpPf2vOm7bnx48A4JEk0OJv0tzy4Vx3/YaMrH6KMAsAYAhaMnd1fvHz3tS/4vhcOn9msQwAjwqB1j5w8MEHZ8eOHcXhIW/l1Z/LJR+/b+r5BYum5JnPOqTYAgBAiX3woqvzvc0/yuHPPTRXLltYLDMEdXR0pL+/3/pZwAFPoMXD8tWuG/Lu+UuTJO+b3ZBjjntBsQUAgBJbs/qrWXftt/OYx/xdVi1bmEOqLLUBwIFDoMVD1vPjn2Tq9HlJkklTXp3XnTK+2AIAQIl94z9uyscuvS5Jsmr5ohw75ohiCwA8qgRaPCT9/f2ZOmN+ftV7d8ZPOCpnn3tysQUAgBK77dafVBaBX/DexjS8tq7YAgCPOoEWD8m0GfNzw/f+K6Of9+xccNGZxTIAACX2u3vuzeILV+ePf/hTppzy+sx+11nFFgA4IAi0eNAWfHhlPv2F9XniE5+QCxaemSc84fHFFgAASmzpvKvy49t/kfFjj87Hl963xAQAHIgEWjwon7x2XS667GNJklkLz8xzD39msQUAgBL7yAevyXe+dXP+6WlPzZXLFhTLAHBAEWjxgL5z49a8beb8JEnje9+UcRPGFFsAACixa9u/mWuu/nqSZNXyhXnOPz2j2AIABxSBFvfrF7++K1Omz02SvOEtL89bznhVsQUAgBL7btct+fdln0mSrLz4wrzypbXFFgA44Ai0uF/Tps/LHT/9ecb+y4ty3qxJxTIAACX2kzt+mSVzVyVJZp49NW97qx2sASgHgRZ71Th3cb72nU151qFPywWLphTLAACU2J///Jcsnrc6v/3tvXnLia/OxdPfXWwBgAOWQIs9Wv6xq/Lx9s9nxN+NyKyFZ+TgqicVWwAAKLGl81bnR7f8OEcf8UKLwANQOgItdvP5zq/ngtZLkyQXLJySFx353GILAAAldsVHvpSvd96Ygw96SlYvX5jHP+5xxRYAOKAJtBhkyw9+lKk7F4Gf1vja/OtrxhZbAAAosa984T/z6U90JElWLVuQF9T45SUA5SPQouK3v/vfTJ0xL//3+z+k7nUvzRlvf02xBQCAEtt647YsW/ipJMklF56fkyaML7YAQCkItKiYOn1ubvnvnhx5VE2aP3BGsQwAQIn96pd9lR0N3z2lIe+ZMrnYAgClIdAiSTJ98SX50te+lX/8x4Mz+yI7GgIADDVL567Or37ZlxNfOS4funB6sQwApSLQIm2f+kw+fOXVSZLmhWfkac+oLrYAAFBiyxZ+KltuvC3PG/WcXLlsYbEMAKUj0BrmOr75nZy7oDVJcv6Fp+boY19QbAEAoMQ+/YmOfOUL/5nH/b//l6uWL8rIg59SbAGA0hFo7UM7duwoDh3Qbrv9zkybMS9JMnnKq3PSG19WbAEAoMQ2XH9jrvjIl5IkVy5bkGOOfFGxBQBKSaC1jxx88MHFoQPaX/7y10ydMS939e3IK171krzj3JOLLQAAlNiPbvlxlsxdnSS56Px35a0nTSy2AEBpCbSGqanT52bT1u/n8Bc8OxcsmlosAwBQYr/97b1ZMu+q/PnPf8m0t7whzedMK7YAQKkJtIah+f/WlvYvd+ZJT/r7XLBwSh73+McWWwAAKLGlc1fnzjv+J6847ph8dPHcYhkASk+gNcysvuaLWfyRK5IksxZOyWE1zyi2AABQYv++7DO5oev7OfSZT8+q5YuKZQAYEgRaw8jGzTfl7bPu26b5XeefkuNfcWSxBQCAEvv8mg25tv2bSZIrly3Ms57+1GILAAwJAq1h4me//FWmzpifJDl50ityyqknFFsAACix73zr5ly2/HNJko8tmZeXH3t0sQUAhgyB1jAxdfq83PmzX+S4cS/OuTPfWiwDAFBiP97+i7TMvypJckHT2zL1za8vtgDAkCLQGgbOnnNRvnFDdw59ztNywcIpxTIAACX2pz/+OUvmXZV7fntvJr12Yha+r6nYAgBDjkBriGtduSqf+Mx1eexjHpNZi6bkKQf9Q7EFAIASWzJ3df77h3dm7D+/2CLwAAwbAq0h7LPrv5o5yy9LksxaNCUvePFzii0AAJTYx/79C/nGf9yUkQc/JauWL8xjH/OYYgsADEkCrSHqpu//MFNnzEuSvK3p9Tmh7phiCwAAJbb+2u9kzarrkySrli3K857rl5cADB8CrSGo7ze/zZTp8/LHP/4p9a//l5x+Vl2xBQCAEvve5h9l+UWfTpJ8eN7MvOaVLyu2AMCQJtAagqbNmJ9be27PmKNHZ+b804tlAABK7H9+cXeWzvtkkuTcqaem6Qw7WAMw/Ai0hpj3X/TBrNuwMU99WlVmLbKjIQDAULNk7ur8+ld9ee0JL88H57y/WAaAYUGgNYRctro9/756TbJzEfinPX1ksQUAgBJr+cAnc/P3tuVFh4/KquULi2UAGDYEWkPE+m905X0XLU+SzJh7Wo465vBiCwAAJfapKzrS+aUb8oTHPy6rli3MQU9+UrEFAIYNgdYQ8KPtd2Tazh0NT51Wl9ecfHyxBQCAEvtax+Z8YsWXkiSrli/KS178gmILAAwrI/r7+/uLgzx0VVVVuf3223PwwQcXS/vVH//0p7x80lm58eYfFEsAQ1bVuDckSfq6vlAsHVDKcp1AeSye8Z7MeKd1UgHADK2SmzZjvjALGHb+99bN+d9bNxeHDzhluU6gHM6a9EZhFgDsZIbWPlJVVZXvfe97Oeyww4olAAAAAPYhM7T2kUf6UUMAAACA4UqgBQAAAECpCLQAAAAAKBWBFgAAAAClItACAAAAoFQEWgAAAACUikALAAAAgFIRaAEAAABQKgItAAAAAEpFoAUAAABAqQi0AAAAACgVgRYAAAAApSLQAgAAAKBUBFoAAAAAlIpACwAAAIBSEWgBAAAAUCoCLQAAAABKRaAFAAAAQKkItPaRgw8+ODt27CgOAwAAALCPCbQAAAAAKBWBFgAAAAClItACAAAAoFQEWgAAAACUikALAAAAgFIRaAEAAABQKgItAAAAAEpFoAUAAABAqQi0AAAAACgVgRYAAAAApSLQAgAAAKBUBFoAAAAAlIpACwAAAIBSEWgBAAAAUCoCLQAAAABKRaAFAAAAQKkItAAAAAAoFYEWAAAAAKUi0AIAAACgVARa+8jBBx+cHTt2FIcBAAAA2McEWgAAAACUikALAAAAgFIRaAEAAABQKgItAAAAAEpFoAUAAABAqQi0AAAAACgVgRYAAAAApSLQAgAAAKBUBFoAAAAAlIpACwAAAIBSEWgBAAAAUCoCLQAAAABKRaAFAAAAQKkItAAAAAAoFYEWAAAAAKUi0AIAAACgVARaAAAAAJSKQAsAAACAUhFo7UM7duwoDgEAAACwjwm09pGDDz64OAQAAADAfiDQAgAAAKBUBFoAAAAAlIpACwAAAIBSEWgBAAAAUCoCLQAAAABKRaAFAAAAQKkItAAAAAAoFYEWAAAAAKUi0AIAAID9YPv27enq6ioOA/uAQAsAAKDkurq6MmLEiAd1PJSAZeAc9q61tTUjRoxIa2trsZTa2tqMHz8+K1euLJYesvt7HxiOBFoAAABDRFVVVerq6u73ePKTn1zpnzNnTurr69Pe3j7odYazfXlPampqUlVVlWc/+9nFEvA3EmgBAAAMEccee2w6Ojru9xgzZkyl/8Ybb0xnZ2fuvPPOQa8znO3Le7J58+bcfffdOfHEE4sl4G8k0AIAAACgVARaAAAAw8zAekydnZ1Jkubm5gdcY2v9+vWpr6+v9I0ePTrr168vtlWsXLkyY8eOHdTf1NSU7du3F1sHrQ+1devWNDQ0DFovatd6b29vmpqaMnr06IwYMSIjR45MU1NTent7iy+bJNm6dWuampoycuTIyrXs6ZHCh3NPHsjA/SqeP/C62cN9HTt27P3e1z1pamqqnLu3+wBDjUALAABgmDn00ENTV1eXqqqqZOdaT3taY2vAnDlzctJJJ2Xbtm2pq6tLbW1tenp6ctJJJ+0W1iRJQ0NDzjnnnPT19WX27NlpaWlJVVVV2traUltbm61btxZPSZLccccdmTBhQtauXZuqqqoceuihg+o33XRTjjvuuLS1tWX06NGpq6tLkrS1teW0004b1Judi+VPmDAhbW1tmThxYlpaWtLY2JhNmzZl8uTJaWpqqvQ+1HuyL+zpvnZ3d+/1vu5JU1NT5b52dHSkurq62AJDUz/7xMknn9x/7bXXFocBAAD2u40bN/Yn6a+rqyuW7lddXV1/kv6WlpZiqb+/v78/SX+S/qqqqv6NGzcOqjU2NvYn6Z80adKg8ZaWlv4k/Y2NjYPG+/v7+9esWbPH6xw4Z+D1enp69lpvbGzsv+uuuyq1LVu2VGpbtmypjN911139VVVV/VVVVYPGB2q1tbX9SXb7XA90T4oGrm1P/QOvVXyP+7uvkyZNut/7uuv7DIzV1tYOuicwHJihBQAAMERs2rQp9fX1ez2Kj9k9WBs2bMi4ceMGjZ166qlJku7u7kHjH/3oR5MkixYtGjSenTO3amtr09nZucdZWpMmTUp7e3tGjRpVLCU76ytWrBg0C2nMmDGVmVo//OEPK+Nf/epX09fXl8bGxkEL4SdJdXV1FixYkCS57LLLBtUeSXu6r+9+97uTPdzXovb29jQ3N5uZxbA1ov++dJi/0Rvf+MZ84xvfyGGHHVYsAQAAPGQbNmzIwQcfXBzeo66urowfP744vJuWlpbMnDmz8u/19fXp7OzcbXzAwDpPe/prY29vbw455JBB9YGxqqqqzJo1q3DGfT760Y+mp6cnGzdurIQ5ra2taW5u3ut1PFB9zpw5Wbx48aD6wNikSZNy9NFHF0/JHXfckba2ttTV1aWjo6My/kD3pOj+rm3gtXb9rHkY9zWF9zn00EMzefJkYRbDmkBrH9mxY0fuuOOO4jAAAMDDcthhhz3kQKsYzjyQBwpv7i94yR7qDzZYS7JPA6091Qc+2wMp3rMHuidFe3rvAQ8n0Mpe6gPvM7DOVgr3EIad4jOIAAAAlMv+XkNrb4r1geuora0d1PdA9rQ+1K4eTn3gs61bt25Q7wN5oHtStKf3HvBAa2jtzZ7qA+8ze/bsyvpfe1qnDIYLa2gBAACwT7zwhS9MHmD9p61bt6arqyu9vb3F0j51zDHHJEm+//3vF0vJzkf7urq69riW14HsoIMOSkdHR2pra9PW1jZop0YYTgRaAAAAw9QJJ5xQHPqbVFdXp7a2Ntm5aPmeNDc3Z/z48YMWcN8fXvaylyW7LFJf9MMf/jDjx49Pc3PzoPGHe08eySVoqqur09HRkZqaGqEWw5ZACwAAYJjbl2HM+eefnyRpamrK9u3bB9W2bt2azs7OVFVVVWZz7S8nnnhiampq0tPTkzlz5hTLld0N9xZgPdh7csQRRyRJNm/eXCztV9XV1bnmmmtSVVWVtra2vQaIMFQJtAAAAIaITZs2pb6+/n6PXR+xq6urS5K0tbXtsf5wNDQ0pLGxMX19famtrU1DQ0NaW1tTX1+fo446KkmyYsWKR2RnvoHAZ/HixRk7dmzmzJmTpqamjB49OmvXrk1tbW3OOuusQec81Hty3HHHpaqqKt3d3ZX3eKSMGTMmGzZsSFVVVSZPnizUYlgRaAEAAAwRfX196ezsvN/jnnvuqfSPGTMm69atS01NzR7rD9eKFSuyZs2aHHvssVm7dm2am5uzadOmTJo0KRs3bkxDQ0PxlP1izJgx6e7urgRsixcvTltbW6qqqtLS0pKOjo7dgrWHek+qq6vzxS9+sbL74I033lhs2a8GQq0kQi2GlRH9e9snFAAAAAAOQGZoAQAAAFAqAi0AAAAASkWgBQAAAECpCLQAAAAAKBWBFgAAAAClItACAAAAoFQEWgAAAACUikALAAAAgFIRaAEAAABQKgItAAAAAEpFoAUAAABAqQi0AAAAACgVgRYAAAAApSLQAgAAAKBUBFoAAAAAlIpACwAAAIBSEWgBAAAAUCoCLQAAAABKRaAFAAAAQKkItAAAAAAoFYEWAAAAAKUi0AIAAACgVARaAAAAAJSKQAsAAACAUhFoAQAAAFAqAi0AAAAASkWgBQAAAECpCLQAAAAAKBWBFgAAAAClItACAAAAoFQEWgAAAACUikALAAAAgFIRaAEAAABQKgItAAAAAEpFoAUAAABAqQi0AAAAACgVgRYAAAAApSLQAgAAAKBUBFoAAAAAlIpACwAAAIBSEWgBAAAAUCoCLQAAAABKRaAFAAAAQKkItAAAAAAoFYEWAAAAAKUi0AIAAACgVARaAAAAAJSKQAsAAACAUhFoAQAAAFAqAi0AAAAASkWgBQAAAECpCLQAAAAAKBWBFgAAAAClItACAAAAoFQEWgAAAACUikALAAAAgFIRaAEAAABQKgItAAAAAEpFoAUAAABAqQi0AAAAACgVgRYAAAAApSLQAgAAAKBUBFoAAAAAlIpACwAAAIBSEWgBAAAAUCoCLQAAAABKRaAFAAAAQKkItAAAAAAoFYEWAAAAAKUi0AIAAACgVARaAAAAAJSKQAsAAACAUhFoAQAAAFAqAi0AAAAASkWgBQAAAECpCLQAAAAAKBWBFgAAAAClItACAAAAoFQEWgAAAACUikALAAAAgFIRaAEAAABQKgItAAAAAEpFoAUAAABAqQi0AAAAACgVgRYAAAAApSLQAgAAAKBUBFoAAAAAlIpACwAAAIBSEWgBAAAAUCoCLQAAAABKRaAFAAAAQKkItAAAAAAoFYEWAAAAAKUi0AIAAACgVARaAAAAAJSKQAsAAACAUhFoAQAAAFAqAi0AAAAASkWgBQAAAECpCLQAAAAAKBWBFgAAAAClItACAAAAoFQEWgAAAACUikALAAAAgFIRaAEAAABQKgItAAAAAEpFoAUAAABAqQi0AAAAACgVgRYAAAAApSLQAgAAAKBUBFoAAAAAlIpACwAAAIBSEWgBAAAAUCoCLQAAAABKRaAFAAAAQKkItAAAAAAoFYEWAAAAAKUi0AIAAACgVARaAAAAAJSKQAsAAACAUhFoAQAAAFAq/x/CApyz0hIrDQAAAABJRU5ErkJggg==)

PQRSTUV is developed as two independent components: Storage Module and Operation Module. The Storage Module is airgapped from the network and has only a serial communication link to the Operation Module. Both modules run custom firmware and do not have a general-purpose operating system.

The system uses two different communication protocols:

- Internal Communication Protocol (ICP): This runs over the serial link and is used only between the Operation Module and Storage Module
- External Communication Protocol (ECP): This runs over network and allows other devices to communicate with the Operation Module.

## Internal Communication Protocol Specification

The storage module and operation modules MUST be connected by a short serial connection, with RS-232, with a baud rate of 9600 bps, on the on-board connectors on the motherboards. The storage module has its own TPM used to hold master keys.

The Storage module MUST NOT have any network card or network stack. The storage module MUST NOT be able to be memory dumped without turning off the module. It MUST NOT have any hibernate or related features that allow memory state to be saved to storage. The TPM MUST be locked with PCR values and MUST NOT be unlocked without the same PCR values. The TPM MUST NOT allow unlocking by other secrets or operations. The storage module MUST implement tamper detection tied to the PCR values. The storage module MUST NOT allow any other form of connectivity than the serial communication running ICP with the operation module. The storage module MUST be shielded in a Faraday-cage-like enclosure/ chassis and MUST have power consumption stabilizers so as to minimize side-channel leakages. Any form of tamper to the chassis or the power stabilizing component MUST trip the PCR values.

The operation module and the storage module communicate with frames of fixed structures as defined in the ICP. The storage module behaves in a request-response manner, in sessions. Except for a few commands, all others are executed only in an authenticated session. This ensures no unauthenticated commands are being executed.

Each frame is defined in the following manner

| Preamble | Payload Length | Payload | Checksum (CRC-32) | Trailer |
| --- | --- | --- | --- | --- |
| 16-byte | 4-byte |     | 4-byte | 16-byte |

The components of the frame described above are:

**Preamble (16-bytes)**: This shows where the frame starts. It is a fixed constant:

`0x00 0x00 0x00 0x00 0x50 0x51 0x52 0x53 0x54 0x55 0x56 0x00 0x00 0x00 0x00 0x00`

**Payload Length (4-bytes)**: This is the length of the payload in bytes. Big-endian encoding is used to convert it to bytes.

**Payload**: The payload is defined in later sections of the specification. It is the commands or their responses.

**Checksum (4-bytes)**: This is the CRC-32 checksum of the Payload Length and Payload section of the frame.

**Trailer (16-bytes)**: This shows where the frame ends. It is a fixed constant:

`0xFF 0xFF 0xFF 0xFF 0x43 0x52 0x59 0x50 0x54 0x41 0x4E 0x45 0xFF 0xFF 0xFF 0xFF`

Further, it is imperative that both modules queue up frames in case there are concurrent ones. While it is generally handled by the kernel of the modules, it is to be considered by independent developers who might be developing the modules from scratch.

It is to be noted that the maximum frame size is 50,000 bytes and any receiving frame greater than that should be dropped. The 50,000 bytes is a generous size limit covering even SLH-DSA-256f signatures which stand at 49,856 bytes.

### Payload:

There are two types of payloads:

- Request payload: This type of payload is sent from the Operation Module to the Storage Module
- Response payload: This type of payload is sent from the Storage Module to the Operation Module.

The two types of payloads are differentiated by the direction of the communication and not by any data flag. They have different structures:

The structure for request payloads is:

| Session | Auth token | Command | Operation Data |
| --- | --- | --- | --- |
| 4-byte | 16-bytes | 1-byte |     |

The structure for response payload is:

| Session | Command | Response code | Response |
| --- | --- | --- | --- |
| 4-byte | 1-byte | 1-byte |     |

The available response codes are:

| **Response** | **Code** |
| --- | --- |
| SUCCESS | `0x00` |
| INVALID_CMD | `0x01` |
| CRYPTO_KEY_MISMATCH | `0x02` |
| INVALID_SYNTAX | `0x03` |
| CHECKSUM_FAIL | `0x04` |
| CMD_REJECTED | `0x05` |
| RATE_LIMITED | `0x06` |
| SESSION_UNAVAILABLE | `0x07` |
| INCORRECT_SECRET | `0x08` |
| CMD_FAIL | `0x09` |
| UNKNOWN_ERR | `0xFF` |

It is to be noted that other than for Response code SUCCESS, the 'Response' field for all other Response packets MUST be empty and have no additional information to prevent information leakage. Further all identical operations, as defined by the same type of operation (decapsulation, signature, hashing, hash comparison, checksum computation, checksum comparison) with same cryptosystem and parameter set MUST be performed in constant time and not leak timing information.

### Request handling:

When the Storage module receives a Request Payload Frame, it identifies the boundaries of the frame by analyzing the preamble and trailer. It then computes checksum over the payload length and payload. \[CRC32(Payload length || Payload)\] and compare the checksum with the one in the request frame. If it does not match, it returns a CHECKSUM_FAIL response. The CHECKSUM_FAIL packet is always sent over session 0xFF 0xFF 0xFF 0xFF and has Command field 0xFF.

If the receiving frame goes over 50,000, the Storage module returns a CMD_REJECTED error. It is always sent over session 0xFF 0xFF 0xFF 0xFF and has command field 0xFF.

Implementation note: The Storage module MAY implement two receiving buffers of size 16-bytes and 50,000 bytes respectively and a receiving flag.

The pseudocode for receiving information is:
```
preamble= 16 byte (const. defined earlier)
trailer= 16 byte (const. defined earlier)
buf1: 16 bytes (queue)
buf2: 50000 bytes (queue)
payload_length: 4 bytes (queue)
recv_flag: boolean = false
ctr: int = 0
receive_data(Incoming_Byte: 1 byte)
{
    if(not recv_flag)
    {
        if(buf1 is full)
        {
            dequeue(buf1, 1 byte)
        }
        enqueue(Incoming_Byte --> buf1)
        if(buf1 == preamble)
        {
            dequeue(buf2, 50000 bytes)
            dequeue(payload_length, 4 bytes)
            recv_flag= true
        }
    }
    else
    {
        if(buf1 is full)
        {
            temp=dequeue(buf1, 1 byte)
        }
        enqueue(Incoming_Byte --> buf1)
        if(buf2 is full or to_integer(payload_length, BIG_ENDIAN)>49960)
        {
            send_error(CMD_REJECTED)
            dequeue(buf2, all)
            dequeue(buf1, all)
            dequeue(payload_length, all)    
            recv_flag=false
        }
        ctr=ctr+1
        enqueue(temp --> buf2)
        if(ctr>=16 && payload_length is not full)
        {
            enqueue(temp --> payload_length)
        }
        if(buf1 == trailer)
        {
            temp=dequeue(buf1, 16 bytes)
            enqueue(temp --> buf2)
            full_frame=dequeue(buf2, all_bytes)
            recv_flag= false
            process_request(full_frame)
        }
    }
}

process_request(full_frame: bytes)
{
    required_info= full_frame.(strip first 16 bytes preamble).(strip last 16 bytes trailer)
    payload_info= full_frame.(strip last 4 bytes)
    checksum=full_frame.(get last 4 bytes)
    if(checksum != CRC32(payload_info))
    {
        send_error(CHECKSUM_FAIL)
    }
    else
    {
        run_command(payload_info) //This function will run the commands described later
    }
}
```
For all commands being executed, the Command field in the response payload MUST be the command code of the respective command.

### Commands:

The available commands for the Storage module are:

| Command | Code |
| --- | --- |
| Device information and session commands | `0x0*` |
| GET_INFO | `0x00` |
| PING | `0x01` |
| INIT | `0x02` |
| Authentication secret management: | `0x1*` |
| SEC_SET_INIT | `0x10` |
| SEC_SET_CONF | `0x11` |
| Reset commands: | `0x2*` |
| DEV_RST | `0x20` |
| CRYPTO_RST | `0x21` |
| Key lifecycle management | `0x3*` |
| KEYGEN | `0x30` |
| KEY_LST | `0x31` |
| KEY_DEL | `0x32` |
| IMPORT | `0x33` |
| GET_PUB | `0x34` |
| Cryptographic operations: | `0x4*` |
| DECAPS | `0x40` |
| SIGN | `0x41` |

The commands that run in an unauthenticated session MUST be run on Session `0x00 0x00 0x00 0x00` and the Auth Token should be `0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00`. The sessions `0x00 0x00 0x00 0x00` and `0xFF 0xFF 0xFF 0xFF` are reserved and MUST NOT be used for authenticated sessions. Any command requiring authenticated sessions sent to these sessions should immediately return error SESSION_UNAVAILABLE in constant time without inspecting the frame further.

Authenticated sessions MUST run only one command only. For more than one command, different sessions are to be used. This prevents leaving authenticated sessions open after the operation is done. However, for multiple sequential operations, application developers are encouraged to use scripts to create sessions sequentially per command. However, applications SHOULD NOT cache/store the user secret for more time than to use the device sequentially for one pre-defined operation. It SHOULD NOT store the user secret while waiting for any process other than waiting for PQRSTUV device. For example, the user may want to run KEYGEN, GET_PUB and SIGN commands sequentially to generate a new keypair, get its public key and sign some data. The application may store the user secret for these 3 only and not while waiting for user input, waiting for any other application or a network call. Applications SHOULD retain user secret only the minimum time required to complete a predefined sequence of operations and MUST NOT persist the secret beyond that. It should be immediately zeroized.

#### Device Information and session commands:

##### GET_INFO (0x00)

GET_INFO command runs in an unauthenticated session. GET_INFO command does not need any Operation data. It returns the device information as CBOR encoded JSON. The information JSON MUST contain a field for 'available_cryptosystems' which is a list containing the COSE Identifiers of the supported algorithms. It MUST contain a field 'token_hash_algo' which is the COSE identifier of the recommended cryptographic hashing algorithm used to generate the Auth tokens. For example, the following JSON shows a GET_INFO output.
```
{
    "name": "PQRSTUV Demo Device",
    "serial_number": "d3f2da78-ca68-4e60-ae6d-b0cc0a503bc8",
    "manufacturer": "Cryptane",
    "documentation": "example.com",
    "available_cryptosystems": [
        -50,
        -49,
        -48,
        -257,
        -7
    ],
    "token_hash_algo": -16
}
```
The GET_INFO command output MUST not change on reboots or by device state. It MAY be cached on the client application.

##### PING (0x01)

PING is used to test the connectivity between the two modules of the device. PING runs in an unauthenticated session. The PING command reads all Operation Data in the request and echoes the same as response.

##### INIT (0x02)

Except for the device information commands and session commands, all other commands require authenticated sessions. Sessions from 0x00 0x00 0x00 0x01 to 0xFF 0xFF 0xFF 0xFE can be randomly allotted.

Each session has three states:

- Unallocated/ Destroyed (UD)
- Allocated, waiting (AW)
- Allocated, processing (AP)

A session set to AW state MUST have a timeout of 10 minutes within which if it does not move to AP state, it will automatically be moved to UD.

INIT runs in an unauthenticated session. It does not require any Operation data. It generates a random session ID which is not in AW or AP states. It further generates a 16-byte Nonce and associates it with the session ID. The session is moved to AW state. The command returns a 20-byte response where the first 4 bytes is the session identifier, and the remaining 16-bytes is the nonce.

| Session Identifier | Nonce |
| --- | --- |
| 4-bytes | 16-bytes |

All other commands require authenticated sessions. To use an authenticated session, the Session field of the command frame MUST contain the session identifier that it had received from the INIT command response. If this is violated, that is if the frame contains a reserved session ID or a session ID in UD state, the error SESSION_UNAVAILABLE is returned without further processing the frame.

The client SHOULD develop the authentication token by concatenating the user secret to the nonce, followed by hashing the same with the algorithm mentioned in 'token_hash_algo' field of the GET_INFO response. The first 16 bytes of the same are used as the authentication token.

`Auth Token = H(Secret || Nonce).truncate(16)`

The Auth Token present in the frame is now validated with the Storage module computing the same. The validation MUST be done in constant time. If the validation fails, the INCORRECT_SECRET error is returned. A violation counter is incremented when the validation fails which is used to implement rate limiting.

The rate limit SHOULD be 3 validation failures in 5 minutes, after which all authenticated requests SHOULD be rate limited for the next 30 minutes. Rate limited requests MUST NOT be parsed, and the RATE_LIMITED error should be returned immediately during this time duration.

#### Authentication secret management commands:

This set of commands is used to change the authentication secret used to generate the authentication token. The secret storage will be described in a later section of 'Secure Storage'. This section assumes the secret is securely stored and can be modified only by these commands.

##### SEC_SET_INIT (0x10):

This command takes 3-byte operation data which contains the COSE identifier of a KEM or Encryption algorithm. The identifier MUST be from the list of 'available_cryptosystems' presented during the GET_INFO call and MUST NOT be a digital signature algorithm. If the identifier is not from the list, the CMD_FAIL error is returned. If it is a digital signature algorithm, the CRYPTO_KEY_MISMATCH error is returned.

The module then generates a keypair of the algorithm referred to by the identifier. This keypair stays in memory and not in storage. The keypair MUST be zeroized after a time-out of 10 minutes. Any other keypairs generated by the same command previously currently in the memory MUST be zeroized immediately.

The response contains the encapsulation key or public key of the newly generated keypair depending on the cryptosystem used. The key is serialized as the CBOR encoding of its COSE format JSON.

##### SEC_SET_CONF (0x11):

The user is expected to enter a new secret on the client device. The secret is encrypted with AES-GCM-256, followed by the AES key being encapsulated or encrypted with the public key/ encapsulation key received in the SEC_SET_INIT call previously. They are appended and is sent as the operation data.

`Operation Data = (Encrypted Secret with AES-GCM-256 || Encapsulated or encrypted AES Key)`

If there was no SEC_SET_INIT call before, or the key was zeroized due to a timeout, the storage module MUST return error CMD_FAIL without further processing of the command.

The AES key is then decapsulated/ decrypted, which is then further used decrypt the user secret. The secret MUST be less than 1024 bytes in size, violation of which will return CMD_FAIL. The user secret is securely stored for future use. A SUCCESS response is returned without any response data. The keypair created during SEC_SET_INIT MUST be zeroized immediately.

#### Reset commands

This set of commands is used to reset certain functionalities of the device

##### DEV_RST (0x20):

All device storage, including the secure storage, the cryptographic storage, user configuration and vendor specific configurations is immediately zeroized and reverted to default configurations. Refer to 'secure storage' section of this document which highlights other cryptographic secrets that MUST be rotated with this command. A SUCCESS response is returned without any response data.

##### CRYPTO_RST (0x21):

All stored cryptographic keys are immediately zeroized and their identifiers are freed. Refer to 'secure storage' section of this document which highlights other cryptographic secrets that MUST be rotated with this command. A SUCCESS response is returned without any response data.

#### Key lifecycle management

This set of commands is used to manage the lifecycle of cryptographic keypairs on the device.

##### KEYGEN (0x30):

This command takes 3-byte operation data which contains the COSE identifier of a cryptographic algorithm. The identifier MUST be from the list of 'available_cryptosystems' presented during the GET_INFO call. If the identifier is not from the list, the CMD_FAIL error is returned.

A new keypair of the given algorithm is generated and a random 16-byte key identifier is generated, which MUST be previously unused. The keypair is saved securely against the 16-byte key identifier and the algorithm identifer. It is immediate zeroized from the memory after storing it in the secure storage.

The command returns the 16-byte identifier in response.

##### KEY_LST (0x31):

This command lists the available keys for a particular cryptosystem. This command takes 3-byte operation data which contains the COSE identifier of a cryptographic algorithm. The identifier MUST be from the list of 'available_cryptosystems' presented during the GET_INFO call. If the identifier is not from the list, the CMD_FAIL error is returned. The storage module MUST NOT load the keypairs into memory from the secure storage while counting. Only the identifiers are to be loaded to memory.

The response contains the count of the number of keypairs for the particular algorithm, in big-endian encoding in the first 4 bytes. The remaining bytes contain 16-byte identifier of each of them, appended in lexicographical order. The order MUST be lexicographical and should not be in be in the order of creation or import, which would leak chronological metadata. Further, it should be easier to sort them in lexicographical order of the identifiers.

##### KEY_DEL (0x32):

This command takes 16-byte operation data which contains the identifier for the key to be deleted. If a key associated with that identifier does not exist, the CMD_FAIL error is returned.

The key associated with the identifier is zeroized, the identifier freed and the command returns SUCCESS without any response data.

##### IMPORT (0x33)

This command takes in CBOR dumped COSE encoding of a keypair. It inspects the algorithm field (1) in the same and if it does not match with any in its own 'available_cryptosystems' list, it MUST immediately return CMD_FAIL and zeroize the input.

A 16-byte random identifier is created, and the private key is stored in the secure storage against the identifier. The 16-byte identifier is returned in response data.

##### GET_PUB (0x34):

This command takes 16-byte operation data which contains the identifier for the key to be deleted. If a key associated with that identifier does not exist, the CMD_FAIL error is returned.

The public key or encapsulating key corresponding to the keypair against the identifier is converted to a COSE dictionary and then CBOR dumped. The keypair is zeroized from the memory after extracting the public key or the encapsulating key and converting it to JSON format. The same is returned in response data.

#### Cryptographic operations

This set of commands is used to perform cryptographic operations with the device

##### DECAPS (0x40):

This command takes the first 16-bytes as the key identifier to be used to decapsulate or decrypt. If there is no keypair corresponding to the identifier in the secure storage, CMD_FAIL is returned. If the keypair corresponding to the identifier is of a Digital signature algorithm, CRYPTO_KEY_MISMATCH is returned.

The remaining operation data contains the ciphertext. If it does not match the ciphertext size of the cryptosystem with parameter set corresponding to the keypair stored against the identifier, CRYPTO_KEY_MISMATCH is returned.

If the ciphertext is decapsulated or decrypted with the private key corresponding to the keypair on secure storage against the identifier in constant time with respect to the algorithm and parameter set. In case of failures, CMD_FAIL should be returned. The plaintext is returned as response data for SUCCESS. The private key or decapsulation key and the plaintext MUST be immediately zeroized after the decapsulation/decryption is done.

##### SIGN (0x41):

This command takes the first 16-bytes as the key identifier to be used to sign. If there is no keypair corresponding to the identifier in the secure storage, CMD_FAIL is returned. If the keypair corresponding to the identifier is of an encapsulation or encryption algorithm, CRYPTO_KEY_MISMATCH is returned.

The remaining operation data contains the cryptographic hash digest of the message to be signed. The HASH should be in SHA3-256

If input size does not match the digest size of the used hashing algorithm, CMD_FAIL should be returned. The digest is now signed with the digital signature algorithm, and the signature is returned as response data of SUCCESS. The private key or signing key MUST be immediately zeroized after the signing is done.

### Secure Storage:

All keypairs MUST be encrypted by AES-GCM-256 before storing it to the standard storage: SSD or Flash. The AES key MUST be generated and stored in a Trusted Platform Module (TPM) and MUST NOT be exportable. The operating system or firmware MUST NOT store any metadata of keypair generation or usage. All cryptographic material MUST immediately be zeroized from memory after using. This AES Key MUST be rotated with the CRYPTO_RST command.

The user secret is also stored in the SSD or Flash after being encrypted with another AES-GCM-256 after padding it to 1024 Bytes. This AES key MUST also be generated and stored in a Trusted Platform Module (TPM) and MUST NOT be exportable.

Both AES Keys in the TPM MUST be rotated with the DEV_RST command.

## External Communication Protocol Specification

The External Communication Protocol (ECP) highlights the communication of the operations module with client and other devices. It is important that the operation module allows connectivity with other devices in order for the device to be usable. It must have a network stack to enable connectivity and works on REST APIs. The operations module MUST run a webserver that allows communication over REST APIs. The operation module MUST NOT allow console access or any other forms of access in wired, wireless, or even physical connection modes. The operation module MUST NOT allow connectivity over any other network ports than the one on which the web server is listening. The operation module MUST have no more than one storage-specific physical connectivity slot (like SD Card or MicroSD card slot) with write-only mechanism and MUST NOT have any general-purpose ports like USB, PCIe etc. The operation module MUST NOT allow any configuration settings and for network configuration it MUST use DHCP and MUST NOT announce itself with mDNS or any other network protocols. The operation module MUST NOT reach out to any servers over the internet and MAY send UDP traffic to a syslog server available on local network. ECP provides specifications on adding a syslog server to operations module. The operation module MUST STRICTLY follow ICP for communication with the storage module over serial link. The operation module SHOULD implement two buffers for the serial data as described in ICP for communicating with the storage module. ECP, wherever mentions Base64 encoding or URL Safe Base64 encoding MUST always be interpreted as URL Safe Base64 encoding without padding. The operation module MAY use asynchronous logic for handling the web server calls but MUST use synchronous command and response queuing for ICP.

The operation module MUST NOT host any static files, debug endpoints, dashboards or any other functionality than the mentioned REST APIs. The operation module MUST have secure connectivity over TLS1.3 or up and the ECP must be executed in secure context only. The operation module TLS certificates will be self-signed due to restricted communication to the internet, however, the ECP provides specifications to export the public key certificate of the TLS which can be added to org-wide CA in enterprise access or to the Certificate Store in client system computers for individual access.

Each ECP API needs an Authorization header as input, which contains the Base64 encoding of the corresponding authorization token as described in ICP.

Request headers:

- Content-Type: application/json
- Session: URL safe Base64 encoded session identifier. It MUST be 'AAAAAA' (Base64 encoding of 0x00 0x00 0x00 0x00) for unauthenticated sessions.
- Authorization: URL safe Base64 encoded authorization token. It MUST be 'AAAAAAAAAAAAAAAAAAAAAA' (Base64 encoding of 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00) for unauthenticated sessions.

Response codes:

- 200: Operation executed
- 400: Input error
- 404: Undefined API
- 403: Authorization header not present or does not encode 16-bytes or Session header not present or does not encode 4-bytes
- 417: Encoding/Decoding failures
- 500: Other errors

The operation module MUST return 200 even if the authorization header is wrong, since the error is handled by the storage module. It is to be noted that in both request and response, if the mentioned data is of type None, it SHOULD be an empty string. The operation module MUST NOT retry ICP commands automatically under any circumstances.

The request structures for POST Requests and response structure for 200 response code are highlighted below. For all other HTTP error codes, the response MUST be empty JSON ({}).

POST Request Structure
```
{
    data: String, JSON or None
}
```
Response structure:
```
{
    code: Big-endian encoding of response code returned by corresponding ICP call. 0 for SUCCESS
    result: String, JSON or None
}
```
The APIs available for ECP are described below:

| Command | Request type | Parameter | Return type |
| --- | --- | --- | --- |
| Device information and session APIs: |     |     |     |
| /info | GET | None | JSON Object |
| /ping | POST | String | String |
| /init | POST | None | JSON Object |
| Authentication secret management: |     |     |     |
| /set_secret | POST | Number | String |
| /confirm_secret | POST | JSON Object | None |
| Reset APIs: |     |     |     |
| /device_reset | POST | None | None |
| /crypto_reset | POST | None | None |
| Key lifecycle management |     |     |     |
| /keygen | POST | Number | String |
| /list_keys | POST | Number | JSON Object |
| /key_delete | POST | String | None |
| /import | POST | String | String |
| /get_public_key | POST | String | String |
| Cryptographic operations: |     |     |     |
| /decapsulate | POST | JSON Object | String |
| /sign | POST | JSON Object | String |
| Operation module management |     |     |     |
| /renew_tls | POST | JSON Object | String |
| /set_syslog | POST | JSON Object | String |

### API Specifications:

All API calls will have an Authorization header as specified previously. The operation module MUST take the Base64 encoded authorization header, decode it to bytes and use it for the corresponding ICP communication. Each API call in ECP has a corresponding ICP call and some additional functionalities. The operation module MUST NOT receive plain text user secret or cache the authorization header.

All POST requests MUST have JSON data in format specified above while GET requests need not have any parameter. POST requests having None as parameter SHOULD use the 'data' field as an empty string. APIs involving reading a 16-byte identifier field from the user in Base64 encoded format MUST ensure that the received identifier is 16-bytes after decoding and if not, immediately return an error code of 417 and stop executing further instructions of the call.

For the corresponding ICP call, if the response code is not 0x00 (SUCCESS), the operation module MUST stop further computation of the call and returns the response with the big-endian encoding of the response code in 'code' and the 'result' field being None.

#### Device information and session APIs

This set of APIs is used to manage the device session states and retrieve information about the device.

##### /info

This API is used to get information about the PQRSTUV device. This is an unauthenticated command. The operation module on receiving this SHOULD send the INFO command to the storage module via ICP. It should decode the response CBOR into JSON Object and it should be the value of the 'data' field in the response.

##### /ping

This API tests the connectivity till the storage module. This is an unauthenticated command. It takes Base64 encoded bytes as data input string, decodes it and makes the PING ICP call with the same data. It re-encodes the response back to Base64 and returns it for response.

##### /init

This API is used to initiate an authenticated session. This is an unauthenticated API. It makes the INIT ICP call. It parses the session identifier and the nonce and encodes them with URL safe Base64 encoding. It makes the response JSON with fields 'session' and 'nonce' with the Base64 strings.

An example response data is:
```
{
    session: "-s76zg",
    nonce: " AAECAwQFBgcICQoLDA0ODw"
}
```
All further APIs are authenticated APIs and require an authenticated session defined by the session and authorization headers.

#### Authentication secret management

This set of APIs is used to manage the user secret used to authorize sessions.

##### /set_secret

This API takes an integer data as an input parameter and converts it to a Big-Endian encoded 3-byte number. It uses this as operation data and makes the SEC_SET_INIT call. It reads the CBOR encoded public key or encapsulation key from the ICP response and converts it to DER format. The DER format is Base64 encoded and returned in the data field of the response.

##### /confirm_secret

This command invokes the SEC_SET_CONF ICP call. Its parameter is a JSON Object with fields 'encrypted_secret' and 'symmetric_key'.

The encrypted_secret is the new user secret, encrypted with AES-GCM-256 and the ciphertext in URL safe Base64 format. The symmetric_key field contains the AES Key encrypted or encapsulated with the public-key or encapsulating key returned by the previous /set_secret call in URL safe Base64 encoding.

An example of request data is:
```
{
    encrypted_secret: URL Safe Base64 Encoded AES Encrypted secret,
    symmetric_key: URL Safe Base64 encoded encrypted/encapsulated AES Key
}
```
The operation module decodes them and makes the SEC_SET_CONF ICP call as per the ICP specifications. It returns a response with None data.

#### Reset APIs

This set of APIs is used to reset certain functionalities of the API.

##### /device_reset

This command invokes the DEV_RST ICP call. It has None type request and responses.

##### /crypto_reset

This command invokes the CRYPTO_RST ICP call. It has None type request and responses.

#### Key lifecycle management

This set of APIs is used to manage lifecycle of cryptographic secrets.

##### /keygen

This API takes an integer data as an input parameter and converts it to a Big-Endian encoded 3-byte number. It uses this as operation data and makes the KEYGEN call. It reads the identifier response from ICP, encodes it to URL Safe Base64 format and returns.

##### /key_delete

This API takes in a 16-byte key identifier encoded as a URL Safe Base64 String and decodes it to bytes. It invokes the ICP command KEY_DEL with the key identifier as parameter. It returns None as response.

##### /import

This command takes in DER encoded keypair in Base64 String as parameter. It converts the same to COSE format and CBOR dumps it. The same is then used to invoke the IMPORT ICP call. The operation module MUST zeroize the received keypair once the ICP invoke is complete. The ICP call returns a 16-byte identifier, which is Base64 encoded and returned as response data string.

##### /get_public_key

This API takes in a 16-byte key identifier encoded as a URL Safe Base64 String and decodes it to bytes. It invokes the ICP command GET_PUB with the key identifier as parameter. It reads the CBOR encoded public key or encapsulation key from the ICP response and converts it to DER format. The DER format is Base64 encoded and returned in the data field of the response.

#### Cryptographic operations

This set of APIs is used to perform cryptographic operations.

##### /decapsulate

This command takes a JSON input with fields 'identifier' and 'ciphertext'. The 'identifier' is the URL Safe Base64 encoding of the key to be used, while 'ciphertext' is the URL Safe Base 64 encoded encapsulated or encrypted secret. An example of the request data is:

```
{
    identifier: URL Safe Base64 Encoded identifier,
    ciphertext: URL Safe Base64 encoded ciphertext
}
```

The operation module decodes them and makes the DECAPS ICP call as per the ICP specifications. It gets the plaintext from the ICP response and encodes it into URL Safe Base64. It returns the same as response data. The operation module MUST immediately zeroize the plaintext after the operation is complete.

##### /sign

This command takes a JSON input with fields 'identifier' and 'document. The 'identifier' is the URL Safe Base64 encoding of the key to be used, while 'document' is the data to be signed. An example of the request data is:
```
{
    identifier: URL Safe Base64 Encoded identifier,
    document: URL Safe Base64 encoded document
}
```

The operation module decodes them and calculates SHA3-256 hash digest of the document. It uses the identifier and the digest and makes the SIGN ICP call as per the ICP specifications. It gets the signature from the ICP response and encodes it into URL Safe Base64. It returns the same as response data.

#### Operation module management

This set of APIs is used to manage the internals of the operation module.

##### /renew_tls

This operation takes in a JSON Object as input containing a field 'export' with a Boolean value, TLS key generation fields as strings and a 16-byte identifier in Base64 encoded format. An example of request data is:

```
{
    export: boolean,
    country_name: String,
    state: String,
    province: String,
    organization_name: String,
    organization_unit_name: String,
    common_name:String,
    identifier: URL Safe Base64 encoded identifier
}
```

The operation module generates a TLS Keypair using the TLS Key generation fields. It generates a certificate signing request from the public key corresponding to the new keypair. It then generates the hash digest of the CSR data. The identifier is decoded to bytes. The identifier and the hash digest are used to make the ICP SIGN call. If the ICP call fails, the request is terminated. The response contains the signature. The signature is appended to the CSR and is used to make the public key certificate in PEM format. If the 'export' boolean is set to 'true', the certificate in CRT and PEM formats is written to the storage media connected to the operation module. The TLS certificates are then rotated to the new certificates. It returns a response with empty data.

The operation module webserver process MUST NOT be involved in generating the TLS Keypair and SHOULD use other vetted applications like OpenSSL to generate the keypair. The webserver process SHOULD open only the public key and CSR. The webserver process MUST NOT communicate with external storage and SHOULD use any operating system process like echo and pipe.

##### /set_syslog

The process to set up a syslog server is a two-step process. The client or user is first expected to create a JSON file containing the syslog server details with fields 'syslog_server_host', 'syslog_port'. An example of the JSON file is:

```
{
    syslog_server_host: 192.168.26.79,
    syslog_port: 514,
}
```

This file is encoded in Base64 format, and the user makes a /sign call to make this an authenticated request.

The /set_syslog call takes a JSON with three parameters, 'syslog_data', 'signature' and 'identifier'. The syslog_data field contains the Base64 encoded JSON file defined at the previous step. The signature field contains the Base64 encoded signature returned in the previous call. The identifier contains the Base64 encoded 16-byte identifier of the key used to sign the request.

The operation module decodes the identifier makes the GET_PUB ICP call and gets the public key corresponding to the keypair with which the request JSON was signed. It then verifies the signature over the 'syslog_data' field with the public key. If the request is valid, the operation module extracts the syslog_server_host and syslog_port values, thus setting it as the new syslog server. If the extraction fails, or the host or port are invalid, the request MUST return a 400 HTTP error code.

### Logging:

If a syslog server is not configured, the operation module MUST NOT log operations since there is no way to extract or analyze the logs. If a syslog server is configured, it SHOULD log all non-0x00 response codes received from ICP with the IP address of the client corresponding to the request. If the syslog server is changed with the /set_syslog call, the operation module MUST report it to the previous syslog server before changing.

All calls of the following categories MUST be logged irrespective of success or failure, including the client IP address from which the request is originating:

- Authentication secret management:
- Key lifecycle management
- Operation module management

The logs MUST never be written to a file on the operation module and MUST instead be sent to the syslog server immediately. The webserver process MUST NOT communicate with the syslog server and MAY use IPC, a sub-process or a call to OS utilities for logging.

Logs MUST NOT contain authorization tokens, session identifiers, cryptographic materials, plaintext secrets or raw request data. Log message formats MUST be stable and MUST NOT include variable-length data derived from the operations. The client IP address used for logging MUST be derived from the TCP connection and MUST NOT be taken from the request headers.

## Deployment guidelines

For secure deployment, the following guidelines SHOULD be followed:

- The REST API Calls over ECP MUST NOT be cached, proxied or be TLS decrypted.
- Proper management of user secret SHOULD be enforced.
- The device SHOULD be deployed in a segmented network and SHOULD NOT be accessible to unauthorized users.
- The device SHOULD have proper physical access management and MUST NOT be physically accessible to unauthorized persons.

## Issues and Contributing

This documentation is available on the repository [AdityaMitra5102/PQRSTUV-Docs](http://github.com/AdityaMitra5102/PQRSTUV-Docs). If any part of this specification appears incorrect, ambiguous, or problematic, please open an issue in the GitHub repository. 

Feedback via direct messages, emails, or informal communication channels will not be tracked and may be missed. All technical discussion and proposed changes should be initiated as GitHub issues or pull requests.